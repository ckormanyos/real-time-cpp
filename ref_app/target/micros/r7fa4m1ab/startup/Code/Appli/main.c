/******************************************************************************************
  Filename    : main.c
  
  Core        : ARM Cortex-M4
  
  MCU         : Renesas R7FA4M1AB
    
  Author      : Chalandi Amine
 
  Owner       : Chalandi Amine
  
  Date        : 22.01.2026
  
  Description : Application main function
  
******************************************************************************************/

//-----------------------------------------------------------------------------------------
// Includes
//-----------------------------------------------------------------------------------------
#include <stdint.h> 
#include "R7FA4M1AB.h"
#include "SysTickTimer.h"

//-----------------------------------------------------------------------------------------
// Defines
//-----------------------------------------------------------------------------------------

//-----------------------------------------------------------------------------------------
// Macros
//-----------------------------------------------------------------------------------------

//-----------------------------------------------------------------------------------------
// Globals
//-----------------------------------------------------------------------------------------
volatile uint32_t SysTickCounter = 0;

//-----------------------------------------------------------------------------------------
// Function Prototypes
//-----------------------------------------------------------------------------------------
void clock_init(void);
void SysTickTimer(void);

//-----------------------------------------------------------------------------------------
/// \brief  
///
/// \param  
///
/// \return 
//-----------------------------------------------------------------------------------------
int main(void);

int main(void)
{
  /* configure pin P111 as output */
  /* disable register write protection for PFS*/
  PMISC->PWPR.bit.B0WI  = 0;
  PMISC->PWPR.bit.PFSWE = 1;

  /* output low */
  PFS->P111PFS.bit.PODR = 0;

  /* configure the pin as output */
  PFS->P111PFS.bit.PDR  = 1;

  /* Set the LED on */
  PFS->P111PFS.bit.PODR ^= 1;

  /* configure and start systick timer */
  SysTickTimer_Init();
  SysTickTimer_Start(SYS_TICK_MS(1));


  /* endless loop */
  while(1);

  return 0;
}

//-----------------------------------------------------------------------------------------
/// \brief  
///
/// \param  
///
/// \return 
//-----------------------------------------------------------------------------------------
void SysTickTimer(void)
{
  static uint32_t count = 0;
  SysTickCounter++;
  count++;
  SysTickTimer_Reload(SYS_TICK_MS(1));
  if (count >= 1000){
  PFS->P111PFS.bit.PODR ^= 1;
  count =0;
  }
}
